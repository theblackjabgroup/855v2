{{ 'shop-the-look.css' | asset_url | stylesheet_tag }}

{% style %}
  :root  {
    --section-color: {{ section.settings.sectionBackground }};
  }
{% endstyle %}

<div class="shop_the_look__container ">

  <div class="shop__the__look__media__container color-{{ section.settings.bannerColor }}">

    {% if section.settings.image != blank %}
      <img
        width="100%"
        height="100%"
        class="media"
        src="{{ section.settings.main_image |  image_url  }}"
        alt="">

    {% else %}
      <div class="shop-look__empty-image media media--placeholder media--16-9">
        <div class="placeholder">{{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}</div>
      </div>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <div class="shop-look__dots">
        <div class="shop-look__dots-container"></div>
        {% for block in section.blocks %}
          <div
            class="shop-look__dots-item-wrap"
            style="top: {{ block.settings.vertical_position}}%; left: {{ block.settings.horizontal_position}}%;"
            {{ block.shopify_attributes }}>
            <button
              class="shop-look__dots-item {{ section.settings.dot_color }}"
              type="button"
              is="toggle-button"
              aria-expanded="false"
              data-look-dot="{{ forloop.index }}">
              <i class="icon {{ icon_style }} fa-plus" style="--fa-secondary-opacity: 1;"></i>
            </button>
          </div>
        {% endfor %}
      </div>
    {% endif %}

  </div>

  {% assign image_ids = "image_1,image_2,image_3,image_4" | split: "," %}

  <div class="slideshow__container">
    <div class="slideshow__media__container">
      {% for image_id in image_ids %}
        {% assign image = section.settings[image_id] %}
        {% if image != blank %}
          <img
            width="100%"
            height="700px"
            class="media"
            src="{{ image | image_url }}"
            alt="">
        {% else %}
          <div style="width: 100%; height: 100%;">
            {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
          </div>
        {% endif %}
      {% endfor %}
    </div>
    <div class="dot__container" style="background-color: {{section.settings.sectionBackground}};">
      {% for image_id in image_ids %}
        <span class="dot" data-dot-index="{{ forloop.index0 }}"></span>
      {% endfor %}
    </div>
  </div>


  <div class="shop__the__look__text__wrapper color-{{ section.settings.bannerColor }} ">
    <div class="shop__the__look__text__container">
      <h1 class="shop__the__look__heading">{{ section.settings.section_heading }}</h1>
      <p class="shop__the__look__description">{{ section.settings.section_description }}</p>
      <button class="shop__the__look__button color-{{ section.settings.bannerColor }}">{{ section.settings.button_text }}</button>
    </div>
  </div>
</div>


<script>

  document.addEventListener("DOMContentLoaded", function () {
    let slideIndex = 0;
    const slides = document.querySelectorAll(".slideshow__media__container .media");
    const placeholders = document.querySelectorAll(".slideshow__media__container .placeholder-svg");
    const dots = document.querySelectorAll(".dot");

    function showSlides() {
        if (slides.length === 0 && placeholders.length === 0) return;

        // Hide all images and placeholders
        slides.forEach(img => img.style.display = "none");
        placeholders.forEach(placeholder => placeholder.style.display = "none");
        dots.forEach(dot => dot.classList.remove("active"));

        // Move to the next slide
        slideIndex = (slideIndex + 1) % (slides.length || placeholders.length);

        // Show the current image or placeholder
        if (slides.length > 0) {
            slides[slideIndex].style.display = "block";
        } else if (placeholders.length > 0) {
            placeholders[slideIndex].style.display = "block";
        }

        // Set the corresponding dot as active
        if (dots.length > 0) {
            dots[slideIndex].classList.add("active");
        }

        setTimeout(showSlides, 5000); // Change image every 3 seconds
    }

    // Function to handle dot clicks
    dots.forEach((dot, index) => {
        dot.addEventListener("click", function () {
            slideIndex = index - 1; // Adjust to match the showSlides logic
            showSlides();
        });
    });

    showSlides(); // Start the slideshow
  });



</script>
{% schema %}
  {
    "name": "Shop the Look",
    "disabled_on": {
      "groups": ["header", "footer"]
    },
    "settings": [
      {
        "type": "color",
        "id": "sectionBackground",
        "label": "Section Color"
      },
      {
        "type": "color_scheme",
        "label": "Banner Color",
        "id": "bannerColor",
        "default": "#000000"
      },
      {
        "type": "image_picker",
        "id": "main_image",
        "label": "Main Look Image"
      },
      {
        "type": "text",
        "id": "section_heading",
        "label": "Section Heading",
        "default": "Shop the Look"
      }, {
        "type": "text",
        "id": "section_description",
        "label": "Section Description",
        "default": "Experience ultimate comfort with our wheelchair's padded armrests. Designed for support and pressure relief, they feature an ergonomic shape and adjustable height for a personalized fit. Enjoy enhanced stability and comfort during every ride!"
      }, {
        "type": "text",
        "id": "button_text",
        "label": "Button Text",
        "default": "Add to cart"
      }, {
        "type": "image_picker",
        "id": "image_1",
        "label": "Image 1"
      }, {
        "type": "image_picker",
        "id": "image_2",
        "label": "Image 2"
      }, {
        "type": "image_picker",
        "id": "image_3",
        "label": "Image 3"
      }, {
        "type": "image_picker",
        "id": "image_4",
        "label": "Image 4"
      }

    ],


    "blocks": [
      {
        "type": "hotspot",
        "name": "Product Hotspot",
        "settings": [
          {
            "type": "product",
            "id": "product",
            "label": "Product"
          }, {
            "type": "range",
            "id": "position_left",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "%",
            "label": "Horizontal Position",
            "default": 50
          }, {
            "type": "range",
            "id": "position_top",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "%",
            "label": "Vertical Position",
            "default": 50
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Shop the Look"

      }
    ]
  }
{% endschema %}